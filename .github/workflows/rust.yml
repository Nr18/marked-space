name: Rust

on:
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]

env:
  CARGO_TERM_COLOR: always

jobs:
  build:
    strategy:
      matrix:
        os: [ubuntu-latest, windows-latest]
    uses: ./.github/workflows/shared-build.yml
    with:
      os: ${{ matrix.os }}
        
  # prerelease:
  #   permissions: write-all
  #   runs-on: ubuntu-latest
  #   needs: build

  #   steps:
  #   # - uses: ncipollo/release-action@v1
  #   #   with:
  #   #     artifacts: "target/release/marked-space"
  #   #     tag: ${{ steps.version.outputs.version }}
  #   #     draft: true
  #   - name: Download all workflow run artifacts
  #     uses: actions/download-artifact@v4

  #   - uses: "marvinpinto/action-automatic-releases@latest"
  #     with:
  #       repo_token: ${{ github.token }}
  #       automatic_release_tag: "latest"
  #       prerelease: true
  #       title: "Development Build"
  #       files: |
  #         ubuntu-latest/marked-space
  #         windows-latest/marked-space.exe
        